# Official Loki Configuration - SingleBinary Mode
# Based on Grafana Labs recommendations (March 2025)
# For small to medium workloads

# Deployment mode - SingleBinary for small clusters
deploymentMode: SingleBinary
# Core Loki configuration
loki:
  # Basic authentication
  auth_enabled: false
  # Schema configuration for v13
  schemaConfig:
    configs:
      - from: "2024-04-01"
        store: tsdb
        object_store: filesystem
        schema: v13
        index:
          prefix: loki_index_
          period: 24h
  # Common configuration for all components
  commonConfig:
    replication_factor: 1
  # Storage configuration for filesystem
  storage:
    type: filesystem
  # Limits configuration
  limits_config:
    retention_period: 744h # 31 days
    allow_structured_metadata: true
    volume_enabled: true
# SingleBinary deployment configuration
singleBinary:
  replicas: 1
  persistence:
    enabled: true
    size: 10Gi
    storageClass: longhorn
  resources:
    requests:
      cpu: 100m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi
# Gateway for HTTP access
gateway:
  enabled: true
  replicas: 1
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi
# Monitoring integration
monitoring:
  serviceMonitor:
    enabled: true
    labels:
      release: kube-prometheus-stack
# Promtail for log collection
promtail:
  enabled: true
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi
# Disable unnecessary components
chunksCache:
  enabled: false
resultsCache:
  enabled: false
minio:
  enabled: false
test:
  enabled: false
